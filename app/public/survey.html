<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Friendly Survey</title>

  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>


<body>

    <h2>Friendly Survey</h2>
    <hr>

    <h3><strong>Your Info</strong></h3>
    <h4>Name (required)</h4>
    <input type="text" id="name" class="form-control" required>

    <h4>Link to Photo Image (required)</h4>
    <input type="text" id="photo" class="form-control" required>

    <hr>


    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="form-group">
                    <label for="question1">Question 1 Question Text</label>
                    <select class="form-control" id="question1">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question2">Question 2 Question Text</label>
                    <select class="form-control" id="question2">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question3">Question 3 Question Text</label>
                    <select class="form-control" id="question3">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question4">Question 4 Question Text</label>
                    <select class="form-control" id="question4">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question5">Question 5 Question Text</label>
                    <select class="form-control" id="question5">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question6">Question 6 Question Text</label>
                    <select class="form-control" id="question6">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question7">Question 7 Question Text</label>
                    <select class="form-control" id="question7">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question8">Question 8 Question Text</label>
                    <select class="form-control" id="question8">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question9">Question 9 Question Text</label>
                    <select class="form-control" id="question9">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="question10">Question 10 Question Text</label>
                    <select class="form-control" id="question10">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
                  
                  <button type="submit" class="btn btn-primary mb-2" id="submit">Submit Answers</button>
            </div>
        </div>
    </div>

  <!-- bootstrap modal for results (found on w3schools.com) -->
  <div id="matchModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Your Best Match!</h4>
        </div>
        <div class="modal-body" id="matchDiv">

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>

</body>


<script>
  // take in user inputs
  $("#submit").on("click", function(event) {
    event.preventDefault();

    // form validation - make sure all fields are filled in
    function validateForm() {
      // check variable
      var valid = true;
      // if any input fields are blank, set check variable to false
      $(".form-control").each(function() {
        if ($(this).val() === "") {
          valid = false;
        };
      });
      
      return valid;
    };

    // if the return of validateForm() is true (all fields filled in), continue to storing user input, posting user data to api route, displaying match results returned from the functionality in that route 
    if (validateForm()) {
      var userData = {
        name: $("#name").val(),
        photo: $("#photo").val(),
        scores: [
          $("#question1").val(),
          $("#question2").val(),
          $("#question3").val(),
          $("#question4").val(),
          $("#question5").val(),
          $("#question6").val(),
          $("#question7").val(),
          $("#question8").val(),
          $("#question9").val(),
          $("#question10").val()
        ]
      };
    
      // post data to friends api
      $.post("/api/friends", userData, function(data) {
        // get the info for the best friend match (from the functionality found in the friends api route) and display it
        $("#matchDiv").append("<p>" + data.name + "</p>");
        $("#matchDiv").append("<img src='" + data.photo + "'>");

        // display the best match modal
        $("#matchModal").modal("toggle");
      });

    } else {
      alert("Please fill out all fields.");
    };

  });
</script>


</html>
